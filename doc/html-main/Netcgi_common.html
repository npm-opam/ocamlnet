<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Netcgi_plex.html">
<link rel="next" href="Netcgi.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Uq_gtk" rel="Chapter" href="Uq_gtk.html">
<link title="Uq_tcl" rel="Chapter" href="Uq_tcl.html">
<link title="Equeue" rel="Chapter" href="Equeue.html">
<link title="Unixqueue" rel="Chapter" href="Unixqueue.html">
<link title="Unixqueue_pollset" rel="Chapter" href="Unixqueue_pollset.html">
<link title="Unixqueue_select" rel="Chapter" href="Unixqueue_select.html">
<link title="Uq_resolver" rel="Chapter" href="Uq_resolver.html">
<link title="Uq_engines" rel="Chapter" href="Uq_engines.html">
<link title="Uq_multiplex" rel="Chapter" href="Uq_multiplex.html">
<link title="Uq_transfer" rel="Chapter" href="Uq_transfer.html">
<link title="Uq_socks5" rel="Chapter" href="Uq_socks5.html">
<link title="Uq_io" rel="Chapter" href="Uq_io.html">
<link title="Uq_lwt" rel="Chapter" href="Uq_lwt.html">
<link title="Uq_libevent" rel="Chapter" href="Uq_libevent.html">
<link title="Uq_mt" rel="Chapter" href="Uq_mt.html">
<link title="Uq_client" rel="Chapter" href="Uq_client.html">
<link title="Uq_server" rel="Chapter" href="Uq_server.html">
<link title="Uq_datagram" rel="Chapter" href="Uq_datagram.html">
<link title="Uq_engines_compat" rel="Chapter" href="Uq_engines_compat.html">
<link title="Equeue_intro" rel="Chapter" href="Equeue_intro.html">
<link title="Equeue_howto" rel="Chapter" href="Equeue_howto.html">
<link title="Netcamlbox" rel="Chapter" href="Netcamlbox.html">
<link title="Netcgi_apache" rel="Chapter" href="Netcgi_apache.html">
<link title="Netcgi_modtpl" rel="Chapter" href="Netcgi_modtpl.html">
<link title="Netcgi_plex" rel="Chapter" href="Netcgi_plex.html">
<link title="Netcgi_common" rel="Chapter" href="Netcgi_common.html">
<link title="Netcgi" rel="Chapter" href="Netcgi.html">
<link title="Netcgi_ajp" rel="Chapter" href="Netcgi_ajp.html">
<link title="Netcgi_scgi" rel="Chapter" href="Netcgi_scgi.html">
<link title="Netcgi_cgi" rel="Chapter" href="Netcgi_cgi.html">
<link title="Netcgi_fcgi" rel="Chapter" href="Netcgi_fcgi.html">
<link title="Netcgi_dbi" rel="Chapter" href="Netcgi_dbi.html">
<link title="Netcgi1_compat" rel="Chapter" href="Netcgi1_compat.html">
<link title="Netcgi_test" rel="Chapter" href="Netcgi_test.html">
<link title="Netcgi_porting" rel="Chapter" href="Netcgi_porting.html">
<link title="Nethttp_client_conncache" rel="Chapter" href="Nethttp_client_conncache.html">
<link title="Nethttp_client" rel="Chapter" href="Nethttp_client.html">
<link title="Nettelnet_client" rel="Chapter" href="Nettelnet_client.html">
<link title="Netftp_data_endpoint" rel="Chapter" href="Netftp_data_endpoint.html">
<link title="Netftp_client" rel="Chapter" href="Netftp_client.html">
<link title="Nethttp_fs" rel="Chapter" href="Nethttp_fs.html">
<link title="Netftp_fs" rel="Chapter" href="Netftp_fs.html">
<link title="Netsmtp" rel="Chapter" href="Netsmtp.html">
<link title="Netpop" rel="Chapter" href="Netpop.html">
<link title="Netldap" rel="Chapter" href="Netldap.html">
<link title="Netclient_tut" rel="Chapter" href="Netclient_tut.html">
<link title="Netgss_bindings" rel="Chapter" href="Netgss_bindings.html">
<link title="Netgss" rel="Chapter" href="Netgss.html">
<link title="Nethttpd_types" rel="Chapter" href="Nethttpd_types.html">
<link title="Nethttpd_kernel" rel="Chapter" href="Nethttpd_kernel.html">
<link title="Nethttpd_reactor" rel="Chapter" href="Nethttpd_reactor.html">
<link title="Nethttpd_engine" rel="Chapter" href="Nethttpd_engine.html">
<link title="Nethttpd_services" rel="Chapter" href="Nethttpd_services.html">
<link title="Nethttpd_plex" rel="Chapter" href="Nethttpd_plex.html">
<link title="Nethttpd_util" rel="Chapter" href="Nethttpd_util.html">
<link title="Nethttpd_intro" rel="Chapter" href="Nethttpd_intro.html">
<link title="Netmcore" rel="Chapter" href="Netmcore.html">
<link title="Netmcore_camlbox" rel="Chapter" href="Netmcore_camlbox.html">
<link title="Netmcore_mempool" rel="Chapter" href="Netmcore_mempool.html">
<link title="Netmcore_heap" rel="Chapter" href="Netmcore_heap.html">
<link title="Netmcore_ref" rel="Chapter" href="Netmcore_ref.html">
<link title="Netmcore_array" rel="Chapter" href="Netmcore_array.html">
<link title="Netmcore_sem" rel="Chapter" href="Netmcore_sem.html">
<link title="Netmcore_mutex" rel="Chapter" href="Netmcore_mutex.html">
<link title="Netmcore_condition" rel="Chapter" href="Netmcore_condition.html">
<link title="Netmcore_queue" rel="Chapter" href="Netmcore_queue.html">
<link title="Netmcore_buffer" rel="Chapter" href="Netmcore_buffer.html">
<link title="Netmcore_matrix" rel="Chapter" href="Netmcore_matrix.html">
<link title="Netmcore_hashtbl" rel="Chapter" href="Netmcore_hashtbl.html">
<link title="Netmcore_process" rel="Chapter" href="Netmcore_process.html">
<link title="Netmcore_tut" rel="Chapter" href="Netmcore_tut.html">
<link title="Netmcore_basics" rel="Chapter" href="Netmcore_basics.html">
<link title="Netplex_types" rel="Chapter" href="Netplex_types.html">
<link title="Netplex_mp" rel="Chapter" href="Netplex_mp.html">
<link title="Netplex_mt" rel="Chapter" href="Netplex_mt.html">
<link title="Netplex_log" rel="Chapter" href="Netplex_log.html">
<link title="Netplex_controller" rel="Chapter" href="Netplex_controller.html">
<link title="Netplex_container" rel="Chapter" href="Netplex_container.html">
<link title="Netplex_sockserv" rel="Chapter" href="Netplex_sockserv.html">
<link title="Netplex_workload" rel="Chapter" href="Netplex_workload.html">
<link title="Netplex_main" rel="Chapter" href="Netplex_main.html">
<link title="Netplex_config" rel="Chapter" href="Netplex_config.html">
<link title="Netplex_kit" rel="Chapter" href="Netplex_kit.html">
<link title="Rpc_netplex" rel="Chapter" href="Rpc_netplex.html">
<link title="Netplex_cenv" rel="Chapter" href="Netplex_cenv.html">
<link title="Netplex_semaphore" rel="Chapter" href="Netplex_semaphore.html">
<link title="Netplex_sharedvar" rel="Chapter" href="Netplex_sharedvar.html">
<link title="Netplex_mutex" rel="Chapter" href="Netplex_mutex.html">
<link title="Netplex_encap" rel="Chapter" href="Netplex_encap.html">
<link title="Netplex_mbox" rel="Chapter" href="Netplex_mbox.html">
<link title="Netplex_internal" rel="Chapter" href="Netplex_internal.html">
<link title="Netplex_intro" rel="Chapter" href="Netplex_intro.html">
<link title="Netplex_advanced" rel="Chapter" href="Netplex_advanced.html">
<link title="Netplex_admin" rel="Chapter" href="Netplex_admin.html">
<link title="Netshm" rel="Chapter" href="Netshm.html">
<link title="Netshm_data" rel="Chapter" href="Netshm_data.html">
<link title="Netshm_hashtbl" rel="Chapter" href="Netshm_hashtbl.html">
<link title="Netshm_array" rel="Chapter" href="Netshm_array.html">
<link title="Netshm_intro" rel="Chapter" href="Netshm_intro.html">
<link title="Netstring_pcre" rel="Chapter" href="Netstring_pcre.html">
<link title="Netconversion" rel="Chapter" href="Netconversion.html">
<link title="Netchannels" rel="Chapter" href="Netchannels.html">
<link title="Netstream" rel="Chapter" href="Netstream.html">
<link title="Netmime_string" rel="Chapter" href="Netmime_string.html">
<link title="Netmime" rel="Chapter" href="Netmime.html">
<link title="Netsendmail" rel="Chapter" href="Netsendmail.html">
<link title="Neturl" rel="Chapter" href="Neturl.html">
<link title="Netaddress" rel="Chapter" href="Netaddress.html">
<link title="Netbuffer" rel="Chapter" href="Netbuffer.html">
<link title="Netmime_header" rel="Chapter" href="Netmime_header.html">
<link title="Netmime_channels" rel="Chapter" href="Netmime_channels.html">
<link title="Neturl_ldap" rel="Chapter" href="Neturl_ldap.html">
<link title="Netdate" rel="Chapter" href="Netdate.html">
<link title="Netencoding" rel="Chapter" href="Netencoding.html">
<link title="Netulex" rel="Chapter" href="Netulex.html">
<link title="Netaccel" rel="Chapter" href="Netaccel.html">
<link title="Netaccel_link" rel="Chapter" href="Netaccel_link.html">
<link title="Nethtml" rel="Chapter" href="Nethtml.html">
<link title="Netstring_str" rel="Chapter" href="Netstring_str.html">
<link title="Netmappings" rel="Chapter" href="Netmappings.html">
<link title="Netaux" rel="Chapter" href="Netaux.html">
<link title="Nethttp" rel="Chapter" href="Nethttp.html">
<link title="Netpagebuffer" rel="Chapter" href="Netpagebuffer.html">
<link title="Netfs" rel="Chapter" href="Netfs.html">
<link title="Netglob" rel="Chapter" href="Netglob.html">
<link title="Netauth" rel="Chapter" href="Netauth.html">
<link title="Netsockaddr" rel="Chapter" href="Netsockaddr.html">
<link title="Netnumber" rel="Chapter" href="Netnumber.html">
<link title="Netxdr_mstring" rel="Chapter" href="Netxdr_mstring.html">
<link title="Netxdr" rel="Chapter" href="Netxdr.html">
<link title="Netcompression" rel="Chapter" href="Netcompression.html">
<link title="Netunichar" rel="Chapter" href="Netunichar.html">
<link title="Netasn1" rel="Chapter" href="Netasn1.html">
<link title="Netasn1_encode" rel="Chapter" href="Netasn1_encode.html">
<link title="Netoid" rel="Chapter" href="Netoid.html">
<link title="Netstring_tstring" rel="Chapter" href="Netstring_tstring.html">
<link title="Netdn" rel="Chapter" href="Netdn.html">
<link title="Netx509" rel="Chapter" href="Netx509.html">
<link title="Netascii_armor" rel="Chapter" href="Netascii_armor.html">
<link title="Nettls_support" rel="Chapter" href="Nettls_support.html">
<link title="Netmech_scram" rel="Chapter" href="Netmech_scram.html">
<link title="Netmech_scram_gssapi" rel="Chapter" href="Netmech_scram_gssapi.html">
<link title="Netmech_scram_sasl" rel="Chapter" href="Netmech_scram_sasl.html">
<link title="Netmech_scram_http" rel="Chapter" href="Netmech_scram_http.html">
<link title="Netgssapi_support" rel="Chapter" href="Netgssapi_support.html">
<link title="Netgssapi_auth" rel="Chapter" href="Netgssapi_auth.html">
<link title="Netchannels_crypto" rel="Chapter" href="Netchannels_crypto.html">
<link title="Netx509_pubkey" rel="Chapter" href="Netx509_pubkey.html">
<link title="Netx509_pubkey_crypto" rel="Chapter" href="Netx509_pubkey_crypto.html">
<link title="Netsaslprep" rel="Chapter" href="Netsaslprep.html">
<link title="Netmech_plain_sasl" rel="Chapter" href="Netmech_plain_sasl.html">
<link title="Netmech_crammd5_sasl" rel="Chapter" href="Netmech_crammd5_sasl.html">
<link title="Netmech_digest_sasl" rel="Chapter" href="Netmech_digest_sasl.html">
<link title="Netmech_digest_http" rel="Chapter" href="Netmech_digest_http.html">
<link title="Netmech_krb5_sasl" rel="Chapter" href="Netmech_krb5_sasl.html">
<link title="Netmech_gs2_sasl" rel="Chapter" href="Netmech_gs2_sasl.html">
<link title="Netmech_spnego_http" rel="Chapter" href="Netmech_spnego_http.html">
<link title="Netchannels_tut" rel="Chapter" href="Netchannels_tut.html">
<link title="Netmime_tut" rel="Chapter" href="Netmime_tut.html">
<link title="Netsendmail_tut" rel="Chapter" href="Netsendmail_tut.html">
<link title="Netulex_tut" rel="Chapter" href="Netulex_tut.html">
<link title="Neturl_tut" rel="Chapter" href="Neturl_tut.html">
<link title="Netsys" rel="Chapter" href="Netsys.html">
<link title="Netsys_posix" rel="Chapter" href="Netsys_posix.html">
<link title="Netsys_pollset" rel="Chapter" href="Netsys_pollset.html">
<link title="Netlog" rel="Chapter" href="Netlog.html">
<link title="Netexn" rel="Chapter" href="Netexn.html">
<link title="Netsys_win32" rel="Chapter" href="Netsys_win32.html">
<link title="Netsys_pollset_posix" rel="Chapter" href="Netsys_pollset_posix.html">
<link title="Netsys_pollset_win32" rel="Chapter" href="Netsys_pollset_win32.html">
<link title="Netsys_pollset_generic" rel="Chapter" href="Netsys_pollset_generic.html">
<link title="Netsys_signal" rel="Chapter" href="Netsys_signal.html">
<link title="Netsys_oothr" rel="Chapter" href="Netsys_oothr.html">
<link title="Netsys_xdr" rel="Chapter" href="Netsys_xdr.html">
<link title="Netsys_rng" rel="Chapter" href="Netsys_rng.html">
<link title="Netsys_crypto_types" rel="Chapter" href="Netsys_crypto_types.html">
<link title="Netsys_types" rel="Chapter" href="Netsys_types.html">
<link title="Netsys_mem" rel="Chapter" href="Netsys_mem.html">
<link title="Netsys_tmp" rel="Chapter" href="Netsys_tmp.html">
<link title="Netsys_sem" rel="Chapter" href="Netsys_sem.html">
<link title="Netsys_pmanage" rel="Chapter" href="Netsys_pmanage.html">
<link title="Netsys_crypto" rel="Chapter" href="Netsys_crypto.html">
<link title="Netsys_tls" rel="Chapter" href="Netsys_tls.html">
<link title="Netsys_ciphers" rel="Chapter" href="Netsys_ciphers.html">
<link title="Netsys_digests" rel="Chapter" href="Netsys_digests.html">
<link title="Netsys_crypto_modes" rel="Chapter" href="Netsys_crypto_modes.html">
<link title="Netsys_gssapi" rel="Chapter" href="Netsys_gssapi.html">
<link title="Netsys_sasl_types" rel="Chapter" href="Netsys_sasl_types.html">
<link title="Netsys_sasl" rel="Chapter" href="Netsys_sasl.html">
<link title="Netsys_polypipe" rel="Chapter" href="Netsys_polypipe.html">
<link title="Netsys_polysocket" rel="Chapter" href="Netsys_polysocket.html">
<link title="Netsys_global" rel="Chapter" href="Netsys_global.html">
<link title="Nettls_gnutls_bindings" rel="Chapter" href="Nettls_gnutls_bindings.html">
<link title="Nettls_nettle_bindings" rel="Chapter" href="Nettls_nettle_bindings.html">
<link title="Nettls_gnutls" rel="Chapter" href="Nettls_gnutls.html">
<link title="Netunidata" rel="Chapter" href="Netunidata.html">
<link title="Netgzip" rel="Chapter" href="Netgzip.html">
<link title="Rpc_auth_local" rel="Chapter" href="Rpc_auth_local.html">
<link title="Rpc_xti_client" rel="Chapter" href="Rpc_xti_client.html">
<link title="Rpc" rel="Chapter" href="Rpc.html">
<link title="Rpc_program" rel="Chapter" href="Rpc_program.html">
<link title="Rpc_util" rel="Chapter" href="Rpc_util.html">
<link title="Rpc_portmapper_aux" rel="Chapter" href="Rpc_portmapper_aux.html">
<link title="Rpc_packer" rel="Chapter" href="Rpc_packer.html">
<link title="Rpc_transport" rel="Chapter" href="Rpc_transport.html">
<link title="Rpc_client" rel="Chapter" href="Rpc_client.html">
<link title="Rpc_simple_client" rel="Chapter" href="Rpc_simple_client.html">
<link title="Rpc_portmapper_clnt" rel="Chapter" href="Rpc_portmapper_clnt.html">
<link title="Rpc_portmapper" rel="Chapter" href="Rpc_portmapper.html">
<link title="Rpc_server" rel="Chapter" href="Rpc_server.html">
<link title="Rpc_auth_sys" rel="Chapter" href="Rpc_auth_sys.html">
<link title="Rpc_auth_gssapi" rel="Chapter" href="Rpc_auth_gssapi.html">
<link title="Rpc_proxy" rel="Chapter" href="Rpc_proxy.html">
<link title="Rpc_intro" rel="Chapter" href="Rpc_intro.html">
<link title="Rpc_mapping_ref" rel="Chapter" href="Rpc_mapping_ref.html">
<link title="Rpc_intro_gss" rel="Chapter" href="Rpc_intro_gss.html">
<link title="Shell_sys" rel="Chapter" href="Shell_sys.html">
<link title="Shell" rel="Chapter" href="Shell.html">
<link title="Shell_uq" rel="Chapter" href="Shell_uq.html">
<link title="Shell_fs" rel="Chapter" href="Shell_fs.html">
<link title="Shell_intro" rel="Chapter" href="Shell_intro.html">
<link title="Intro" rel="Chapter" href="Intro.html">
<link title="Platform" rel="Chapter" href="Platform.html">
<link title="Foreword" rel="Chapter" href="Foreword.html">
<link title="Ipv6" rel="Chapter" href="Ipv6.html">
<link title="Regexp" rel="Chapter" href="Regexp.html">
<link title="Tls" rel="Chapter" href="Tls.html">
<link title="Crypto" rel="Chapter" href="Crypto.html">
<link title="Authentication" rel="Chapter" href="Authentication.html">
<link title="Credentials" rel="Chapter" href="Credentials.html">
<link title="Gssapi" rel="Chapter" href="Gssapi.html">
<link title="Ocamlnet4" rel="Chapter" href="Ocamlnet4.html">
<link title="Get" rel="Chapter" href="Get.html"><link title="Arguments" rel="Section" href="#2_Arguments">
<link title="Cookies" rel="Section" href="#2_Cookies">
<link title="Cookies" rel="Section" href="#2_Cookies">
<link title="Environment" rel="Section" href="#2_Environment">
<link title="CGI" rel="Section" href="#2_CGI">
<link title="Exceptions" rel="Section" href="#2_Exceptions">
<link title="Useful functions" rel="Section" href="#2_Usefulfunctions">
<title>Ocamlnet 4 Reference Manual : Netcgi_common</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Netcgi_plex.html" title="Netcgi_plex">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Netcgi.html" title="Netcgi">Next</a>
</div>
<h1>Module <a href="type_Netcgi_common.html">Netcgi_common</a></h1>

<pre><span class="keyword">module</span> Netcgi_common: <code class="code">sig</code> <a href="Netcgi_common.html">..</a> <code class="code">end</code></pre><div class="info module top">
Functions to develop new connectors.
<p>

 The following module is provided as a set of helper functions to
 define new connectors.  As a normal user of <code class="code">Netcgi</code>, <b>you should
 not use this module</b>.<br>
</div>
<hr width="100%">
<br>
The goal of this module is to factor out common routines to easily
    set up new connectors.  Here is the normal flow of operations:
<p>
<ul>
<li>You start by reading the request environment properties as well
    as the input header.  Often both are undistinguished and provided
    through some sort of meta-variables.  The function
    <a href="Netcgi_common.html#VALupdate_props_inheader"><code class="code">Netcgi_common.update_props_inheader</code></a> helps you to sort them and
    to normalize the input header fields.  You also need to set up a
    <a href="Netchannels.out_obj_channel-c.html"><code class="code">Netchannels.out_obj_channel</code></a> to the output stream of your
    connector.  Then, <a href="Netcgi_common.cgi_environment-c.html"><code class="code">Netcgi_common.cgi_environment</code></a> can create an
    environment object for you.  If <code class="code">stderr</code> output is not appropriate
    (e.g. ot is not redirected to the server log), you need to
    override <code class="code">#log_error</code>.</li>
</ul>
<ul>
<li>From the environment object and arguments, <a href="Netcgi_common.cgi-c.html"><code class="code">Netcgi_common.cgi</code></a>
    creates a CGI object.  Often, arguments are read from the
    environment <code class="code">#cgi_query_string</code> (in case of GET) or from an input
    channel (in case of POST).  <a href="Netcgi_common.html#VALcgi_with_args"><code class="code">Netcgi_common.cgi_with_args</code></a> handles
    this for you: it requires a <a href="Netchannels.in_obj_channel-c.html"><code class="code">Netchannels.in_obj_channel</code></a> from
    which the arguments are read (only used in the case of POST).</li>
</ul>
<ul>
<li><a href="Netcgi_common.html#VALexn_handler_default"><code class="code">Netcgi_common.exn_handler_default</code></a> provides a default error
    page for uncaught exceptions.  It also allows the user to pass his
    own exception handler that has precedence on the default one.</li>
</ul>

    To see this schema in use, we recommend you have a look to the
    implementation of the CGI connector because it is very simple.<br>
<br>
The goal of this module is to factor out common routines to easily
    set up new connectors.  Here is the normal flow of operations:
<p>
<ul>
<li>You start by reading the request environment properties as well
    as the input header.  Often both are undistinguished and provided
    through some sort of meta-variables.  The function
    <a href="Netcgi_common.html#VALupdate_props_inheader"><code class="code">Netcgi_common.update_props_inheader</code></a> helps you to sort them and
    to normalize the input header fields.  You also need to set up a
    <a href="Netchannels.out_obj_channel-c.html"><code class="code">Netchannels.out_obj_channel</code></a> to the output stream of your
    connector.  Then, <a href="Netcgi_common.cgi_environment-c.html"><code class="code">Netcgi_common.cgi_environment</code></a> can create an
    environment object for you.  If <code class="code">stderr</code> output is not appropriate
    (e.g. ot is not redirected to the server log), you need to
    override <code class="code">#log_error</code>.</li>
</ul>
<ul>
<li>From the environment object and arguments, <a href="Netcgi_common.cgi-c.html"><code class="code">Netcgi_common.cgi</code></a>
    creates a CGI object.  Often, arguments are read from the
    environment <code class="code">#cgi_query_string</code> (in case of GET) or from an input
    channel (in case of POST).  <a href="Netcgi_common.html#VALcgi_with_args"><code class="code">Netcgi_common.cgi_with_args</code></a> handles
    this for you: it requires a <a href="Netchannels.in_obj_channel-c.html"><code class="code">Netchannels.in_obj_channel</code></a> from
    which the arguments are read (only used in the case of POST).</li>
</ul>
<ul>
<li><a href="Netcgi_common.html#VALexn_handler_default"><code class="code">Netcgi_common.exn_handler_default</code></a> provides a default error
    page for uncaught exceptions.  It also allows the user to pass his
    own exception handler that has precedence on the default one.</li>
</ul>

    To see this schema in use, we recommend you have a look to the
    implementation of the CGI connector because it is very simple.<br>
<br>
<h2 id="2_Arguments">Arguments</h2><br>

<pre><span id="TYPErepresentation"><span class="keyword">type</span> <code class="type"></code>representation</span> = <code class="type">[ `MIME of <a href="Netmime.html#TYPEmime_message">Netmime.mime_message</a> | `Simple of <a href="Netmime.mime_body-c.html">Netmime.mime_body</a> ]</code> </pre>


<pre><span id="TYPEstore"><span class="keyword">type</span> <code class="type"></code>store</span> = <code class="type">[ `File of string | `Memory ]</code> </pre>


<pre><span id="EXCEPTIONOversized"><span class="keyword">exception</span> Oversized</span></pre>
<div class="info ">
See <a href="Netcgi.Argument.html#EXCEPTIONOversized"><code class="code">Netcgi.Argument.Oversized</code></a>.<br>
</div>

<pre><span id="EXCEPTIONToo_many_arguments"><span class="keyword">exception</span> Too_many_arguments</span></pre>
<div class="info ">
Hit the limit <code class="code">max_arguments</code><br>
</div>

<pre><span id="TYPEcgi_argument"><span class="keyword">class type</span> <a href="Netcgi_common.cgi_argument-c.html">cgi_argument</a></span> = <code class="code">object</code> <a href="Netcgi_common.cgi_argument-c.html">..</a> <code class="code">end</code></pre><div class="info">
See <a href="Netcgi.cgi_argument-c.html"><code class="code">Netcgi.cgi_argument</code></a>.
</div>

<pre><span id="TYPErw_cgi_argument"><span class="keyword">class type</span> <a href="Netcgi_common.rw_cgi_argument-c.html">rw_cgi_argument</a></span> = <code class="code">object</code> <a href="Netcgi_common.rw_cgi_argument-c.html">..</a> <code class="code">end</code></pre><div class="info">
<span class="deprecated">See <a href="Netcgi.rw_cgi_argument-c.html"><code class="code">Netcgi.rw_cgi_argument</code></a>.
</span></div>

<pre><span name="TYPEsimple_arg"><span class="keyword">class</span> <a href="Netcgi_common.simple_arg-c.html">simple_arg</a></span> : <code class="type">?ro:bool -> string -> string -> </code><code class="type"><a href="Netcgi_common.rw_cgi_argument-c.html">rw_cgi_argument</a></code></pre><div class="info">
See <a href="Netcgi.Argument.html#VALsimple"><code class="code">Netcgi.Argument.simple</code></a>.
</div>

<pre><span name="TYPEmime_arg"><span class="keyword">class</span> <a href="Netcgi_common.mime_arg-c.html">mime_arg</a></span> : <code class="type">?work_around_backslash_bug:bool -> ?name:string -> <a href="Netmime.html#TYPEmime_message">Netmime.mime_message</a> -> </code><code class="type"><a href="Netcgi_common.rw_cgi_argument-c.html">rw_cgi_argument</a></code></pre><div class="info">
See <a href="Netcgi.Argument.html#VALmime"><code class="code">Netcgi.Argument.mime</code></a>.
</div>
<br>
<h2 id="2_Cookies">Cookies</h2><br>
<br>
<h2 id="2_Cookies">Cookies</h2><br>
<br>
The cookie implementation has been moved to <a href="Nethttp.Cookie.html"><code class="code">Nethttp.Cookie</code></a>.
    New code should directly call the functions defined there.<br>

<pre><span class="keyword">module</span> <a href="Netcgi_common.Cookie.html">Cookie</a>: <code class="code">sig</code> <a href="Netcgi_common.Cookie.html">..</a> <code class="code">end</code></pre><br>
<h2 id="2_Environment">Environment</h2><br>

<pre><code><span id="TYPEconfig"><span class="keyword">type</span> <code class="type"></code>config</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.tmp_directory">tmp_directory</span>&nbsp;: <code class="type">string</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.tmp_prefix">tmp_prefix</span>&nbsp;: <code class="type">string</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.permitted_http_methods">permitted_http_methods</span>&nbsp;: <code class="type">[ `DELETE | `GET | `HEAD | `POST | `PUT ] list</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.permitted_input_content_types">permitted_input_content_types</span>&nbsp;: <code class="type">string list</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.input_content_length_limit">input_content_length_limit</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.max_arguments">max_arguments</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.workarounds">workarounds</span>&nbsp;: <code class="type">[ `Backslash_bug<br>       | `MSIE_Content_type_bug<br>       | `Work_around_MSIE_Content_type_bug<br>       | `Work_around_backslash_bug ] list</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconfig.default_exn_handler">default_exn_handler</span>&nbsp;: <code class="type">bool</code>;</code></td>

</tr></table>
}

<div class="info ">
See <a href="Netcgi.html#TYPEconfig"><code class="code">Netcgi.config</code></a>.<br>
</div>


<pre><span id="TYPEoutput_type"><span class="keyword">type</span> <code class="type"></code>output_type</span> = <code class="type">[ `Direct of string<br>       | `Transactional of<br>           <a href="Netcgi_common.html#TYPEconfig">config</a> -><br>           <a href="Netchannels.out_obj_channel-c.html">Netchannels.out_obj_channel</a> -> <a href="Netchannels.trans_out_obj_channel-c.html">Netchannels.trans_out_obj_channel</a> ]</code> </pre>
<div class="info ">
See <a href="Netcgi.html#TYPEoutput_type"><code class="code">Netcgi.output_type</code></a>.<br>
</div>


<pre><span id="VALfix_MSIE_Content_type_bug"><span class="keyword">val</span> fix_MSIE_Content_type_bug</span> : <code class="type">string -> string</code></pre><div class="info ">
<code class="code">fix_MSIE_Content_type_bug ct</code> transforms the content-type
      string <code class="code">ct</code> to fix the MSIE Content-Type bug.<br>
</div>

<pre><span id="VALis_MSIE"><span class="keyword">val</span> is_MSIE</span> : <code class="type">string -> bool</code></pre><div class="info ">
<code class="code">is_MSIE user_agent</code> tells whether the <code class="code">user_agent</code> is Microsoft
      Internet Explorer.  Useful to know when to apply
      <a href="Netcgi_common.html#VALfix_MSIE_Content_type_bug"><code class="code">Netcgi_common.fix_MSIE_Content_type_bug</code></a>.<br>
</div>

<pre><span name="TYPEcgi_environment"><span class="keyword">class</span> <a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a></span> : <code class="type">config:<a href="Netcgi_common.html#TYPEconfig">config</a> -> properties:(string * string) list -> input_header:(string * string) list -> <a href="Netchannels.out_obj_channel-c.html">Netchannels.out_obj_channel</a> -> </code><code class="code">object</code> <a href="Netcgi_common.cgi_environment-c.html">..</a> <code class="code">end</code></pre><div class="info">
<code class="code">new cgi_environment ~config ~properties ~input_header out_obj</code>
    generates a <a href="Netcgi.cgi_environment-c.html"><code class="code">Netcgi.cgi_environment</code></a> object, from the arguments.
</div>
<br>
<h2 id="2_CGI">CGI</h2><br>

<pre><span id="TYPEother_url_spec"><span class="keyword">type</span> <code class="type"></code>other_url_spec</span> = <code class="type">[ `Env | `None | `This of string ]</code> </pre>
<div class="info ">
See <a href="Netcgi.html#TYPEother_url_spec"><code class="code">Netcgi.other_url_spec</code></a>.<br>
</div>


<pre><span id="TYPEquery_string_spec"><span class="keyword">type</span> <code class="type"></code>query_string_spec</span> = <code class="type">[ `Args of <a href="Netcgi_common.rw_cgi_argument-c.html">rw_cgi_argument</a> list<br>       | `Env<br>       | `None<br>       | `This of <a href="Netcgi_common.cgi_argument-c.html">cgi_argument</a> list ]</code> </pre>
<div class="info ">
See <a href="Netcgi.html#TYPEquery_string_spec"><code class="code">Netcgi.query_string_spec</code></a>.<br>
</div>


<pre><span id="TYPEcache_control"><span class="keyword">type</span> <code class="type"></code>cache_control</span> = <code class="type">[ `Max_age of int | `No_cache | `Unspecified ]</code> </pre>
<div class="info ">
See <a href="Netcgi.html#TYPEcache_control"><code class="code">Netcgi.cache_control</code></a>.<br>
</div>


<pre><span id="TYPErequest_method"><span class="keyword">type</span> <code class="type"></code>request_method</span> = <code class="type">[ `DELETE | `GET | `HEAD | `POST | `PUT of <a href="Netcgi_common.cgi_argument-c.html">cgi_argument</a> ]</code> </pre>


<pre><span id="VALstring_of_request_method"><span class="keyword">val</span> string_of_request_method</span> : <code class="type"><a href="Netcgi_common.html#TYPErequest_method">request_method</a> -> string</code></pre>
<pre><span id="TYPEarg_store_type"><span class="keyword">type</span> <code class="type"></code>arg_store_type</span> = <code class="type">[ `Automatic<br>       | `Automatic_max of float<br>       | `Discard<br>       | `File<br>       | `File_max of float<br>       | `Memory<br>       | `Memory_max of float ]</code> </pre>


<pre><span id="TYPEarg_store"><span class="keyword">type</span> <code class="type"></code>arg_store</span> = <code class="type"><a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -><br>       string -> <a href="Netmime.mime_header_ro-c.html">Netmime.mime_header_ro</a> -> <a href="Netcgi_common.html#TYPEarg_store_type">arg_store_type</a></code> </pre>
<div class="info ">
See <a href="Netcgi.html#TYPEarg_store"><code class="code">Netcgi.arg_store</code></a>.<br>
</div>


<pre><span name="TYPEcgi"><span class="keyword">class</span> <a href="Netcgi_common.cgi-c.html">cgi</a></span> : <code class="type"><a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -> <a href="Netcgi_common.html#TYPEoutput_type">output_type</a> -> <a href="Netcgi_common.html#TYPErequest_method">request_method</a> -> <a href="Netcgi_common.cgi_argument-c.html">cgi_argument</a> list -> </code><code class="code">object</code> <a href="Netcgi_common.cgi-c.html">..</a> <code class="code">end</code></pre><div class="info">
<code class="code">cgi env op meth args</code> constructs <a href="Netcgi.cgi-c.html"><code class="code">Netcgi.cgi</code></a> objects.
</div>

<pre><span id="VALcgi_with_args"><span class="keyword">val</span> cgi_with_args</span> : <code class="type">(<a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -><br>        <a href="Netcgi_common.html#TYPEoutput_type">output_type</a> -><br>        <a href="Netcgi_common.html#TYPErequest_method">request_method</a> -> <a href="Netcgi_common.cgi_argument-c.html">cgi_argument</a> list -> 'a) -><br>       <a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -><br>       <a href="Netcgi_common.html#TYPEoutput_type">output_type</a> -><br>       <a href="Netchannels.in_obj_channel-c.html">Netchannels.in_obj_channel</a> -> <a href="Netcgi_common.html#TYPEarg_store">arg_store</a> -> 'a</code></pre><div class="info ">
<code class="code">cgi_with_args (new cgi) env out op ?put_arg in_chan</code> constructs
      a <a href="Netcgi.cgi-c.html"><code class="code">Netcgi.cgi</code></a> object.  However, <code class="code">new cgi</code> can be replaced by
      any function, so it is easy to use this to construct extensions
      of the <code class="code">cgi</code> class (as needed by some connectors).  The
      arguments of the cgi object are taken from the environment <code class="code">env</code>
      (for HEAD, GET, DELETE) or from the <code class="code">in_chan</code> (for POST, PUT)
      and processed according to <code class="code">arg_store</code>.<br>
<b>Raises</b> <code>HTTP</code> if the data does not conform the standards or it not
      allowed.<br>
</div>
<br>
<h2 id="2_Exceptions">Exceptions</h2><br>

<pre><span id="EXCEPTIONHTTP"><span class="keyword">exception</span> HTTP</span> <span class="keyword">of</span> <code class="type"><a href="Nethttp.html#TYPEhttp_status">Nethttp.http_status</a> * string</code></pre>
<div class="info ">
Exception raised by various functions of this library to return
      to the user agent an appropriate error page with the specified
      http-status (this exception must be caught by the connector and
      a default answer sent).
<p>

      The string is a description of the cause of the error.
<p>

      This exception is for use by connectors only, users should deal
      with the exceptions in their code by generating a response with
      the usual <code class="code">#set_header</code> and <code class="code">#out_channel</code> of <a href="Netcgi.cgi-c.html"><code class="code">Netcgi.cgi</code></a>.<br>
</div>

<pre><span id="VALexn_handler_default"><span class="keyword">val</span> exn_handler_default</span> : <code class="type"><a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -><br>       exn_handler:(<a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -> (unit -> unit) -> unit) -><br>       finally:(unit -> unit) -> (unit -> exn option) -> unit</code></pre><div class="info ">
<code class="code">exn_handler_default env ~exn_handler ~finally run_cgi</code> will
      basically execute <code class="code">exn_handler env run_cgi</code>.  Provided that the
      environment config <code class="code">default_exn_handler</code> is set to <code class="code">true</code> (the
      default), any exception <code class="code">e</code> not caught by the user provided
      <code class="code">exn_handler</code> (or that is raised by it) will be passed to the
      default handler of OCamlNet which will rollback the current
      output, produce a page describing the exception <code class="code">e</code>, and close
      the output channel of <code class="code">env</code>.  Note that the default handler
      treats <code class="code">HTTP</code> exceptions specially -- for example, the response
      to <code class="code">HTTP(`Method_not_allowed,...)</code>  includes an "Allow" header
      (as mandated by HTTP/1.1);...
<p>

      Note that, regardless of the value of <code class="code">default_exn_handler</code>, the
      <code class="code">Exit</code> exception is always caught and treated like an
      acceptable early termination (thus produces no error page).
<p>

      Whether <code class="code">run_cgi</code> terminates normally or by an exception,
      <code class="code">finally()</code> is executed last.
<p>

      Sometimes, you want that some "special" exceptions (for example
      exceptions internal to the connector) CANNOT to be caught by
      <code class="code">exn_handler</code>.  In this case, <code class="code">run_cgi()</code> catches the exception,
      say <code class="code">e</code>, and returns it as <code class="code">Some e</code>.  The exception <code class="code">e</code> will "go
      through" <code class="code">exn_handler_default</code>, it will not even be passed to
      the default handler.  Therefore, you must take care that it is
      handled by the surrounding code or your connector may die
      without an error message.  Of course, <code class="code">run_cgi</code> must return
      <code class="code">None</code> if no "special" exception is raised.
<p>

      REMARK: Stricly speaking, <code class="code">exn_handler env run_cgi</code> is obviously
      not possible because the return type of <code class="code">run_cgi</code> is not <code class="code">unit</code>
      but you can ignore that to understand what this function does.<br>
</div>

<pre><span id="VALerror_page"><span class="keyword">val</span> error_page</span> : <code class="type"><a href="Netcgi_common.cgi_environment-c.html">cgi_environment</a> -><br>       <a href="Nethttp.html#TYPEhttp_status">Nethttp.http_status</a> -><br>       (string * string list) list -> string -> string -> unit</code></pre><div class="info ">
<code class="code">error_page env status fields msg detail</code>: Logs an error message and
      outputs an error page via <code class="code">env</code>.
<p>

      <code class="code">status</code> is the status of the error page, e.g. <code class="code">`Internal_server_error</code>.
      <code class="code">fields</code> are put into the response header of the error page.
<p>

      <code class="code">msg</code> occurs in the log message and in the error page, and should
      be a concise description without linefeeds. <code class="code">detail</code> is only
      printed to the error page, and may be longer than this, and may
      also include HTML markup.<br>
</div>
<br>
<h2 id="2_Usefulfunctions">Useful functions</h2>
<p>

    The following functions are used in several connectors and are
    gouped here for convenience.<br>

<pre><span id="VALupdate_props_inheader"><span class="keyword">val</span> update_props_inheader</span> : <code class="type">string * string -><br>       (string * string) list * (string * string) list -><br>       (string * string) list * (string * string) list</code></pre><div class="info ">
<code class="code">update_props_inheader (name, value) (props, inheader)</code> returns
      <code class="code">(props, inheader)</code> to which the new parameter <code class="code">name</code>-<code class="code">value</code>
      has been added -- to <code class="code">props</code> or <code class="code">inheader</code>, depending on <code class="code">name</code>.
      Unless you know what you are going, you <b>must</b> use this
      function to classify parameters as it also performs some
      standardisation.<br>
</div>

<pre><span id="VALrm_htspace"><span class="keyword">val</span> rm_htspace</span> : <code class="type">(char -> bool) -> string -> int -> int -> string</code></pre><div class="info ">
<code class="code">rm_htspace is_space s low up</code> returns the substring <code class="code">s.[low
      .. up - 1]</code> stripped of possible heading and trailing spaces
      identified by the function <code class="code">is_space</code>.<br>
<b>Raises</b> <code>Invalid_argument</code> if <code class="code">low &lt; 0</code> or <code class="code">up &gt; String.length s</code><br>
</div>

<pre><span id="VALrev_split"><span class="keyword">val</span> rev_split</span> : <code class="type">(char -> bool) -> string -> string list</code></pre><div class="info ">
<code class="code">split_rev is_delim s</code> split <code class="code">s</code> at each character <code class="code">is_delim</code>
      and returns the list of substrings in reverse order.  Several
      consecutive delimiters are treated as a single one.  The
      substrings do not share <code class="code">s</code> memory.<br>
</div>

<pre><span id="VALis_prefix"><span class="keyword">val</span> is_prefix</span> : <code class="type">string -> string -> bool</code></pre><div class="info ">
<code class="code">is_prefix pre s</code> checks whether <code class="code">pre</code> is a prefix of <code class="code">s</code>.<br>
</div>

<pre><span id="TYPEhttp_method"><span class="keyword">type</span> <code class="type"></code>http_method</span> = <code class="type">[ `DELETE | `GET | `HEAD | `POST | `PUT ]</code> </pre>


<pre><span id="VALstring_of_http_method"><span class="keyword">val</span> string_of_http_method</span> : <code class="type"><a href="Netcgi_common.html#TYPEhttp_method">http_method</a> -> string</code></pre><div class="info ">
Returns the string value of the method<br>
</div>
</body></html>